{% extends "base.html" %}

{% block content %}
<h2 style="margin-top:0;">Student Dashboard</h2>
<p class="hint">Enter the OTP shared by your teacher to mark attendance.</p>

{% if success %}
  <div class="alert good">Attendance Marked ✅</div>
{% elif error %}
  <div class="alert bad">Invalid / Expired OTP ❌</div>
{% endif %}

<div class="card">
  <h3>Mark Attendance</h3>
  <p>OTP is valid only for a short time.</p>

  <form action="/submit_otp" method="POST" style="margin-top:12px;">
    <div class="field">
      <label>Enter OTP</label>
      <input type="text" name="otp" placeholder="Enter 6-digit OTP" required>
    </div>

    <div class="actions">
      <button class="btn primary" type="submit">Submit OTP</button>
    </div>
  </form>

  <div id="timerBox" class="pill" style="margin-top:12px; display:inline-block;">
    OTP valid for <span id="timer">60</span> sec
  </div>
</div>

<script>
let timeLeft = 60;
const timerEl = document.getElementById("timer");
const timerBox = document.getElementById("timerBox");

setInterval(() => {
  timeLeft--;
  if (timeLeft <= 0) {
    timerEl.innerText = "0";
    timerBox.innerText = "OTP expired ❌";
    return;
  }
  timerEl.innerText = timeLeft;
}, 1000);
</script>

<div class="small-link">
  Next: Profile • Schedule • Attendance history (Step 3)
</div>
{% endblock %}
